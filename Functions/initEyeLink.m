function [el, error]=initEyeLink(RunName)%% Initializes eyeLink-connection, creates edf-file% and writes experimental parameters to edf-file% % 2008 by Martin Rolfsglobal const scr%---------------------%% define edf-filename %%---------------------%edffilename = strcat(RunName,'.edf');% dummymode (mouse is tracked) or eyelink connected (eyes are tracked)error=0;if const.EYETRACK	if (Eyelink('initialize') ~= 0)        Eyelink('initializedummy');	endelse	Eyelink('initializedummy');end% create edf-filei = Eyelink( 'openfile', edffilename);if i~=0	fprintf('Cannot create EDF file ''%s'' ', edffilename);	Eyelink( 'Shutdown');	return;end% set eyelink defaultsel=EyelinkInitDefaults(scr.windowPtr);%---------------------------------------%% general information on the experiment %%---------------------------------------%Eyelink('command', 'add_file_preamble_text ''Recorded with SaccadeFeature''');%   SET UP TRACKER CONFIGURATIONEyelink('command', 'calibration_type = HV9');Eyelink('command', 'link_event_filter = LEFT,RIGHT,BUTTON');Eyelink('command', 'link_sample_data  = LEFT,RIGHT,GAZE,AREA');Eyelink('command', 'heuristic_filter = 1 1');%--------------------------------------------------------%% write descriptions of the experiment into the edf-file %%--------------------------------------------------------%Eyelink('message', 'BEGIN OF DESCRIPTIONS');Eyelink('message', 'Subject code: %s', RunName);Eyelink('message', 'END OF DESCRIPTIONS');%--------------------------------------%% modify a few of the default settings %%--------------------------------------%el.backgroundcolour = scr.bgColor;		% background color when calibratingel.foregroundcolour = scr.black;        % foreground color when calibratingel.calibrationfailedsound = 0;				% no sounds indicating success of calibrationel.calibrationsuccesssound = 0;% test mode of eyelink connectionstatus = Eyelink('isconnected');switch status    case -1        fprintf(1, 'Eyelink in dummymode.\n\n');    case  0        fprintf(1, 'Eyelink not connected.\n\n');    case  1        fprintf(1, 'Eyelink connected.\n\n');endif Eyelink('isconnected')==el.notconnected    Eyelink('closefile');    Eyelink('shutdown');    Screen('closeall');    return;enderror=el.ABORT_EXPT;